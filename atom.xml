<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf=8"></meta>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
    <meta name="viewport" content="width=device-width, initial-scale=1"></meta>

    <title></title>
    <meta name="description"
        content="P is mute"></meta>
    <meta name="keywords"
        content="Learning"></meta>
    <meta name="author"
        content="Changwoo Park"></meta>

    <link rel="shortcut icon" href="images/favicon.ico"></link>
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png"></link>
    <link rel="apple-touch-icon" sizes="72x72"
        href=" ='images/apple-touch-icon-72x72.png"></link>
    <link rel="apple-touch-icon" sizes="114x114"
        href="images/apple-touch-icon-114x114.png"></link>
    <link rel="alternate" type="application/atom+xml"
        title=" &raquo; Feed"
        href="https://pismute.github.io/atom.xml"></link>

    <link rel="stylesheet" media="screen, projection"
        href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"></link>
    <link rel="stylesheet" media="screen, projection"
        href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.2.2/css/material-wfont.css"></link>
    <link rel="stylesheet" media="screen, projection"
        href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.2.2/css/ripples.css"></link>
    <link rel="stylesheet" media="screen, projection"
        href="/styles/style.css"></link>
</head>

<body>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

    <nav class="navbar navbar-default navbar-static-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">@</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/site/archive.html">Archive</a></li>
                    <li><a href="/site/keyword-map.html">Keyword Map</a></li>
                </ul>
                <form id="search-form" class="navbar-form navbar-right"
                        action="http://google.com/search" method="get">
                    <input type="hidden" name="q"
                        value="site:pismute.github.io"></input>
                    <input class="form-control" type="text"
                        name="q" results="0" placeholder="Search..."></input>
                </form>
            </div><!--/.nav-collapse -->
        </div>
    </nav>
    <div class="container">
        <div>
          <?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[  ]]></title>
    <link href="https://pismute.github.io/'atom.xml'}}}" rel="self" />
    <link href="https://pismute.github.io/" />
    <updated>2015-04-08T07:56:49.938Z</updated>
    <id>https://pismute.github.io/</id>
    <entry>
    <title><![CDATA[ Better English ]]></title>
    <link herf="http://pismute.github.io/2015/better-english.html" />
    <updated>2015-04-08T07:56:49.941Z</updated>
    <id>http://pismute.github.io/2015/better-english.html</id>
    <content type="html"><![CDATA[
        <h1 id="better-english">Better English</h1>
<blockquote>
<p>최근부터는 단순히 영어를 수정한 커밋 메시지는 ‘better English’라고 남긴다. 뭐라 해야 할지 고민하다가 이렇게 쓰는 사람을 발견하곤 따라하고 있다.</p>
</blockquote>
<p>2003년도에 <a href="http://www.imdb.com/title/tt0242888/">The Sleeping Dictionary</a>라는 영화가 있었다. <del>흑발 글래머</del> 제시카 알바가 주연으로 나오고 ‘역시 언어는 연애다’라는 훈훈한 교훈을(?) 주던 영화였다. 신체 건강한 상상을 할 수도 있겠지만, 이 영화는 별로 건강하지 않다.</p>
<p><img src="better-english_the-sleeping-dictionary.jpg" alt=""></p>
<p>누군가 내가 사용하는 언어에 대해서 계속 지적질을 해주면 참 좋겠다 싶었다. 그럼 재밌게 배울 수 있을 것 같았다. <del>금발 글래머라면</del> 사람이면 더 좋겠지만, 지적질 도구라도 좋다.</p>
<p>나는 우리말 쓰기에 있어서 <a href="http://urimal.cs.pusan.ac.kr/urimal_new/">우리말 배움터</a>의 도움을 많이 받았다. 이 글도 <a href="http://urimal.cs.pusan.ac.kr/urimal_new/">우리말 배움터</a>가 없으면 오탈자가 너무 많아서 읽기 힘들었을지도 모른다.</p>
<p>사실 도구덕분에 글쓰기가 향상된다기 보다 그냥 꾸준히 쓰면 는다. 하지만 <a href="http://urimal.cs.pusan.ac.kr/urimal_new/">우리말 배움터</a>가 없었다면 용기가 없어 글을 써보려고도 못했을 것 같다. 도덕적으로 완벽한 문법이 아니라는 사실이 괴롭혔을 것이다.</p>
<p>영어로 글을 쓸 기회를 만들기란 정말 쉽지 않은데, GitHub 덕분에 조금이나마 기회가 늘고 있다. Progit 원문에 틀린 점을 찾아서(겨우 단어 두 개 바꿨는데) <a href="https://github.com/progit/progit2/pull/232">PR</a>을 보냈는데 바로 문법이 틀렸다고 다른 분이 고쳐줬었다. 이럴 때는 ‘우리말 배움터’가 많이 아쉽다.</p>
<p>도구의 한계는 분명하다. 단순한 것밖에 지적해주지 않는다. 나는 ‘우리말 배움터’같은 도구가 그 자체로도 유용하지만 자신감도 불어넣어 준다고 본다. 계속 노력하면 언젠가 익히는 수준을 넘어 자신만의 스타일을 가질 수 있겠지만, <del>글래머</del>도구가 있으면 좀 더 쉽다. 용기도 주고 지적질도 해준다. 한계는 분명하지만 분투하는 과정에서 많은 것을 배울 수 있다.</p>
<h2 id="-">엔지니어의 글쓰기</h2>
<p><a href="http://rs.io/software-writers-tools-improve-writing/">Software For Writers: Tools To Improve Your Writing</a>라는 글에서 엔지니어의 글쓰기는 “Be brief, Avoid adverbs.”해야 한다고 설파한다. 이 글은 영어 쓰기에서 도움 받을 수 있는 도구가 어떤 것들이 있고 어디에 쓰는지를 소개하는데 재밌다.</p>
<p>이 글에서 하는 조언은 아래와 같다.</p>
<h3 id="spell-checking">Spell Checking</h3>
<p>철자 검사기는 최신 에디터나 브라우저에서는 대부분 지원한다. 메뉴를 찾아보면 해당 메뉴가 있을 거고 철자가 틀린 경우 빨간 줄도 그어준다.</p>
<p>VI나 ‘Emacs’같은 경우는 ‘aspell’이나 ‘hunspell’을 사용하면 된다.</p>
<h3 id="weasel-words">Weasel Words</h3>
<blockquote>
<p>얼버무리는 말, 모호한 말 - 다음 사전</p>
<p>예) many, extremely, interestingly, surprisingly</p>
</blockquote>
<p>분명하게 쓰라는 거다.</p>
<ul>
<li>Weasel words를 쓰지 말 것.</li>
<li>수동태를 쓰지 말 것.</li>
</ul>
<p>영어의 수동태는 괜찮다고 생각했는데 아닌 것 같다.</p>
<p>아래와 같은 글은:</p>
<blockquote>
<p>“The Yankees are one of the greatest baseball teams in history”</p>
</blockquote>
<p>이렇게 고치는 게 좋다:</p>
<blockquote>
<p>“The New York Yankees have won 26 World Series championships—almost three times as many as any other team”</p>
</blockquote>
<p>Matt Might라는 Utah대 교수는 Weasel Words와 수동태를 검사하는 <a href="http://matt.might.nethttps:/pismute.github.io/articles/shell-scripts-for-passive-voice-weasel-words-duplicates/">쉘 스크립트</a>를 만들었다. <a href="https://github.com/robertseaton/writegood-mode">writegood-mode</a>는 이 스크립트를 보고 만들어졌다.</p>
<h3 id="clich-s">Clichés</h3>
<blockquote>
<p>진부한 표현, 진부한, 판에 박은 문구 - 다음 사전</p>
</blockquote>
<p>이것도 쓰지 말란다. 조지 오웰의 글도 인용하고 있다.</p>
<blockquote>
<p>Never use a metaphor, simile, or other figure of speech which you are used to seeing in print. - George Orwell, “Politics and the English Language”</p>
</blockquote>
<p>되도록 분명하고 직접적으로 표현하는게 좋다고 한다.</p>
<p><a href="http://cliche.theinfo.org/">Cliche finder</a>라는 도구로 쉽게 내 글에 얼마나 Cliche가 있는지 확인할 수 있다.</p>
<h3 id="grammar-checking">Grammar Checking</h3>
<p>문법 검사야말로 꼭 필요한 도구다. 나는 영어를 못하기 때문에 <code>We is</code>라든가 <code>a editor</code>라든가 하는 실수가 잦다. 문법 검사 도구는 앞으로 계속 유용하게 쓸 것 같다. 단순히 문법 검사만 하는 게 아니라 종합적으로 검사해준다:</p>
<ul>
<li><a href="https://www.languagetool.org/">https://www.languagetool.org/</a> 은 오픈 소스 도구다. 많은 언어를 지원하지만 한국어는 없다. 웹에서 사용할 수도 있고 설치해서 사용할 수도 있다. Mac이라면 <code>brew install languagetool</code>으로 설치한다.</li>
<li><a href="http://nitpickertool.com/">http://nitpickertool.com/</a> 도 LanguageTool과 비슷한데 결과가 다르다. 아직 사용한지 얼마 되지 않아서 어떤 도구가 더 좋은지 모르겠다.</li>
</ul>
<h3 id="readability">Readability</h3>
<p><a href="http://en.wikipedia.org/wiki/Literacy_in_the_United_States#National_Assessment_of_Adult_Literacy_.28NAAL.29">미국인의 평균 읽기 능력은 7~8학년 수준</a>이라서 그 수준으로 글을 써야 한다고 한다. 내 고민은 수준과 상관없이 많이 쓰는 것이라서 이 부분을 살펴보면서 긴장이 풀렸다. 쉽게도 쓸 수 없는데 뭐 이 정도 쯤이야,ㅎㅎ.</p>
<p><a href="http://en.wikipedia.org/wiki/Readability#Readability_and_newspaper_readership">Wikipedia의 Readability</a>에 따르면 인기 있는 TV Guide와 Readers Digest는 9학년 수준 정도로 쓰였고 “Wallaces’ Farmer”라는 잡지는 1947년에 9학년 수준에서 6학년 수준으로 낮추었더니 Readability가 43%나 상승했었다고 한다.</p>
<p><a href="http://www.aladin.co.kr/shop/wproduct.aspx?ISBN=899179940X">번역의 탄생</a>에서 배웠던 것 중 대부분 까먹었지만, 같은 말이면 짧게 쓰라는 말은 잊지 않고 있다. 같은 뜻이면 가장 짧은 표현이 옳다고 믿는다. 영어도 그런 게 아닐까.</p>
<p>영어에는 신비롭게도 Readability를 검사할 수 있는 도구가 있다. 놀랍다. Readability를 검사하는 알고리즘이 있는 것도 신기하고 언젠가 한번 구경하고 싶지만, 요즘은 시간이 없어서 안될 것 같다.</p>
<p>나 같은 사람은 굳이 Readability 평가하지 않아도 어렵게 쓸 수 없다는 사실에 일이 준 것 같아서 잠시 좋았다(?).</p>
<p>Readability를 평가하는 몇 가지 지표가 있는데 <a href="https://github.com/robertseaton/writegood-mode">writegood-mode</a>에서 내장된 두 가지 지표만 소개한다(<del>살펴봤다</del>). 실제로 이 두 지표가 중요 지표인 것 같다.</p>
<ul>
<li><p><a href="http://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests#Flesch.E2.80.93Kincaid_Grade_Level">Flesch–Kincaid Grade Level</a>: 미국에서 사용하는 등급으로 10까지는 대충 그 학년까지 수학한 수준을 의미하고 10 이상은 측정하기 어렵다.</p>
</li>
<li><p><a href="http://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests#Flesch_Reading_Ease">Flesch-Kincaid Reading Ease</a>: 이 수치는 낮을수록 높은 수준이다:</p>
<ul>
<li><code>90.0–100.0</code>: 11살 학생 수준.</li>
<li><code>60.0– 70.0</code>: 13 ~ 15 살 학생 수준.</li>
<li><code>0.0– 30.0</code>: 대학생 수준.</li>
</ul>
</li>
</ul>
<p><a href="https://readability-score.com/">https://readability-score.com/</a> 에서 내 글의 Readability를 검사해볼 수 있다. 내가 README에 썼던 문장을 넣으면 8~10정도 나온다. 컴퓨터 용어라서 그런가!! 이해할 수 없다.</p>
<h3 id="-">체크리스트</h3>
<p>마지막으로 체크리스트를 만들어서 지키면 도움이 된다는 건데, 이 부분을 읽으면서는 끝없이 부끄러웠다. 알고 있지만 잘 실천하지 못한다.</p>
<p><a href="http://rs.io/software-writers-tools-improve-writing/">Software For Writers: Tools To Improve Your Writing</a>에서는 필자의 체크리스트를 소개하고 있다.</p>
<p>당장 실천할 수 있는 수단이라는 점에서 체크리스트는 가장 우수한 도구라고 생각하지만, 시간이 없어지고 바빠지면 흐지부지돼버린다.</p>
<h2 id="javascript">Javascript</h2>
<p>이글은 <a href="https://github.com/btford/write-good">write-good</a>이라는 모듈을 발견해서 쓰게 됐다. <a href="http://urimal.cs.pusan.ac.kr/urimal_new/">우리말 배움터</a>를 상상하고 여기저기 뒤져보니까 정말 있었다.</p>
<p>Javascript 라이브러리들:</p>
<ul>
<li><a href="https://github.com/btford/write-good">write-good</a>: weasel words와 수동태 등을 검사.</li>
<li><a href="https://github.com/GitbookIO/rousseau">rousseau</a>: <a href="https://github.com/btford/write-good">write-good</a>과 비슷.</li>
<li><a href="https://github.com/atom/node-spellchecker">node-spellchecker</a>: atom의 spellchecker</li>
</ul>
<p>찾아보면 더 많을 것 같다.</p>
<h2 id="emacs">Emacs</h2>
<p>Emacs에는 관련 도구들이 잘 통합돼 있다.</p>
<ul>
<li><a href="https://github.com/mhayashi1120/Emacs-langtool">langtool-mode</a>: “Language Tool”을 Emacs에서 사용할 수 있도록 해주는 mode</li>
<li><a href="https://github.com/robertseaton/writegood-mode">writegood-mode</a>: Weasel words나 수동태를 쓰면 다른 색으로 표기해준다.</li>
<li><a href="http://sachachua.com/blog/2011/12/emacs-artbollocks-mode-el-and-writing-more-clearly/">artbollocks-mode</a>: <a href="https://github.com/robertseaton/writegood-mode">writegood-mode</a>와 비슷하다는데 써보지 않았다.</li>
</ul>
<h3 id="spell-checker">Spell Checker</h3>
<p>Emacs에서 Spell Checker는 Aspell이나 Hunspell을 연동해서 쓴다. <a href="http://blog.binchen.org/posts/what-s-the-best-spell-check-set-up-in-emacs.html">What is the best spell check set up in emacs</a>이란 글에서 설명해주는데 설명이 기가 막히다. Aspell이 더 좋다고 설명하는데 나는 잘 모르겠다. 설명한 대로 했는데 잘 모르겠더라.</p>
<p>Hunspell을 사용하면 사전을 추가로 설정해야 하는데 <a href="https://github.com/titoBouzout/Dictionaries">https://github.com/titoBouzout/Dictionaries</a> 에서 받을 수 있다. 여기서 사전을 내려받아서 <code>~/Library/Spelling</code>에 넣어 준다. <code>en_US.aff</code>, <code>en_US.dic</code>처럼 적당한 이름으로 바꿔서 넣는다.</p>
<p>Homebrew로 설치한 Aspell은 왠지 사전을 요구하지 않아서 찾아보지 않았다.</p>
<h2 id="-">유료</h2>
<p>사서 쓰면 편하겠지. <del>금발 글래머가</del>제시카 알바가 그래머(Grammar)를 지적해줄지도 몰라.</p>
<ul>
<li><a href="http://www.hemingwayapp.com/">http://www.hemingwayapp.com/</a></li>
</ul>
<h2 id="-">참고</h2>
<p>이 글은 아래 세 글을 정리한 것이다.</p>
<ul>
<li><a href="http://rs.io/software-writers-tools-improve-writing/">Software For Writers: Tools To Improve Your Writing</a></li>
<li><a href="https://github.com/btford/write-good">write-good</a></li>
<li><a href="http://blog.binchen.org/posts/what-s-the-best-spell-check-set-up-in-emacs.html">What is the best spell check set up in emacs</a></li>
</ul>

    ]]></content>
    </entry>
    <entry>
    <title><![CDATA[ dashbars ]]></title>
    <link herf="http://pismute.github.io/2015/dashbars.html" />
    <updated>2015-04-08T07:56:49.942Z</updated>
    <id>http://pismute.github.io/2015/dashbars.html</id>
    <content type="html"><![CDATA[
        <h1 id="dashbars">dashbars</h1>
<blockquote>
<p><a href="http://handlebarsjs.com/">Handlebarsjs</a>용 헬퍼 라이브러리. <a href="https://github.com/magnars/dash.el">dash.el</a>, <a href="https://github.com/magnars/s.el">s.el</a>, <a href="https://github.com/rejeep/f.el">f.el</a>, <a href="https://github.com/assemble/handlebars-helpers">handlebars-helpers</a>을 참고해서 만들었다.</p>
</blockquote>
<pre><code><div class="highlight"><pre><span class="p">{{</span><span class="o">-</span><span class="nx">take</span> <span class="mi">5</span> <span class="p">(</span><span class="o">-</span><span class="nx">drop</span> <span class="mi">3</span> <span class="p">(</span><span class="o">-</span><span class="nx">range</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">))}}</span> <span class="c1">// [3,4,5,6,7]</span>
<span class="p">{{</span><span class="o">-</span><span class="nx">slice</span> <span class="mi">0</span> <span class="mi">5</span> <span class="p">(</span><span class="o">-</span><span class="nx">range</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">)}}</span> <span class="c1">// [0,1,2,3,4]</span>

<span class="p">{{</span><span class="err">#</span><span class="nx">each</span> <span class="p">(</span><span class="o">-</span><span class="nx">take</span> <span class="mi">5</span> <span class="p">(</span><span class="o">-</span><span class="nx">drop</span> <span class="mi">3</span> <span class="p">(</span><span class="o">-</span><span class="nx">range</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">)))}}</span> <span class="c1">// [3,4,5,6,7]</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="k">else</span><span class="p">}}</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="err">/each}}</span>

<span class="p">{{</span><span class="err">#</span><span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="nx">lt</span><span class="o">?</span> <span class="mi">3</span> <span class="nx">myVar</span><span class="p">)}}</span> <span class="c1">// 3 &lt; myVar</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="k">else</span><span class="p">}}</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="err">/if}}</span>
</pre></div>

</code></pre><h2 id="handlebars-subexpression">Handlebars의 Subexpression</h2>
<p><a href="http://handlebarsjs.com/">Handlebarsjs</a>는 <code>{{}}</code> 와 같은 템플릿을 사용하는데 Subexpression을 지원한다. 아래처럼 생겼다:</p>
<pre><code><div class="highlight"><pre><span class="p">{{</span><span class="nx">outer</span><span class="o">-</span><span class="nx">helper</span> <span class="p">(</span><span class="nx">inner</span><span class="o">-</span><span class="nx">helper</span> <span class="s1">&#39;abc&#39;</span><span class="p">)</span> <span class="s1">&#39;def&#39;</span><span class="p">}}</span>
</pre></div>

</code></pre><p>그러니까 기본 적으로 헬퍼는 <code>{{operator operand1 operand2 ...}}</code> 식으로 사용할 수 있고 Subexpresion도 가능해서 <code>{{operator (operator ...) ...}}</code>와 같은 형식이 가능하다. 중첩도 돼서 <code>{{operator (operator (operator ...)) ...}}</code>와 같은 형식도 가능하다.</p>
<p>이 모습은 lisp이랑 닮았다. 함수를 바로 정의해서 사용할 수 없는 점을 제외하면 lisp이랑 닮았다. lisp의 <a href="https://github.com/magnars/dash.el">dash.el</a>같은 라이브러리가 <a href="http://handlebarsjs.com/">Handlebarsjs</a>에도 필요하다고 생각이 들었다. 그래서 <a href="https://github.com/pismute/dashbars">dashbars</a>라는 헬퍼 라이브러리를 만들었다.</p>
<h2 id="dashbars">Dashbars</h2>
<p>이름은 <a href="https://github.com/magnars/dash.el">dash.el</a>에서 따왔고 <a href="https://github.com/magnars/dash.el">dash.el</a>, <a href="https://github.com/rejeep/f.el">f.el</a>, <a href="https://github.com/magnars/s.el">s.el</a>, <a href="https://github.com/assemble/handlebars-helpers">handlebars-helpers</a>를 참고해서 만들었다.</p>
<p>되도록 JavaScript의 기본 API를 사용했고 없으면 <code>lodash</code>를 사용했다. 이렇게 성능은 브라우저와 lodash에게 묻어 간다. ㅎㅎ</p>
<h3 id="-">함수</h3>
<p><a href="http://handlebarsjs.com/">Handlebarsjs</a>에서는 함수를 정의할 수 없기 때문에 따로 헬퍼 함수를 정의하고 함수 이름을 사용하도록 했다. 아래와 같이 헬퍼를 정의하면:</p>
<pre><code><div class="highlight"><pre><span class="nx">Handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="s1">&#39;-as-is&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">o</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

</code></pre><p><code>-map</code> 헬퍼에 <code>-as-is</code>라는 헬퍼를 넘긴다.</p>
<pre><code><div class="highlight"><pre><span class="p">{{</span><span class="o">-</span><span class="nx">map</span> <span class="s1">&#39;-as-is&#39;</span> <span class="p">(</span><span class="o">-</span><span class="nx">range</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">)}}</span> <span class="c1">// [0,1,2,3,4]</span>
</pre></div>

</code></pre><h3 id="-">좀 더 함수형으로</h3>
<p>아규먼트로 받은 리스트나 객체를 그대로 리턴하지 않는다. 리턴하는 객체는 항상 새로운 객체다. <code>-sort</code> 헬퍼의 예를 들면 아래처럼 아규먼트로 받은 리스트를 복사해서(slice) 정렬한다(sort).</p>
<pre><code><div class="highlight"><pre><span class="nx">registerHelpers</span><span class="p">(</span><span class="s1">&#39;-sort&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">compare</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">list</span><span class="p">.</span><span class="nx">slice</span><span class="p">().</span><span class="nx">sort</span><span class="p">(</span><span class="nx">compare</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

</code></pre><p>Javascript에서 대부분의 Array 함수들은 새로운 Array를 반환하는데 특이하게도 sort는 새 Array를 반환하지 않는다.</p>
<h3 id="-">블럭 헬퍼가 없다.</h3>
<p><a href="https://github.com/pismute/dashbars">dashbars</a>에는 블럭 헬퍼가 없다. 이미 <a href="http://handlebarsjs.com/">Handlebarsjs</a>에 들어 있는 블럭 헬퍼로도 충분하다고 생각한다:</p>
<pre><code><div class="highlight"><pre><span class="p">{{</span><span class="err">#</span><span class="nx">each</span> <span class="p">(</span><span class="o">-</span><span class="nx">take</span> <span class="mi">5</span> <span class="p">(</span><span class="o">-</span><span class="nx">drop</span> <span class="mi">3</span> <span class="p">(</span><span class="o">-</span><span class="nx">range</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">)))}}</span> <span class="c1">// [3,4,5,6,7]</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="k">else</span><span class="p">}}</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="err">/each}}</span>

<span class="p">{{</span><span class="err">#</span><span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="nx">lt</span><span class="o">?</span> <span class="mi">3</span> <span class="nx">myVar</span><span class="p">)}}</span> <span class="c1">// 3 &lt; myVar</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="k">else</span><span class="p">}}</span>
    <span class="p">...</span>
<span class="p">{{</span><span class="err">/if}}</span>
</pre></div>

</code></pre><h3 id="predicate">Predicate</h3>
<p><code>true/false</code>를 리턴하는 Predicate 함수의 이름은 <code>?</code>으로 끝난다.</p>
<h3 id="nodejs">nodejs</h3>
<p><code>f-</code>로 시작하는 파일관련 헬퍼는 nodejs에서만 사용할 수 있고 브라우저에서 사용할 수 없다. <code>path</code> 모듈에 크게 의존한다.</p>
<h3 id="es6">ES6</h3>
<p>ES6는 아직 고려하지 않았다. 하지만 앞으로 Set, Map, Generator를 지원할 계획이다.</p>

    ]]></content>
    </entry>
    <entry>
    <title><![CDATA[ d3js: chapter 12. geomapping ]]></title>
    <link herf="http://pismute.github.io/d3js/12-geomapping.html" />
    <updated>2015-04-08T07:56:49.943Z</updated>
    <id>http://pismute.github.io/d3js/12-geomapping.html</id>
    <content type="html"><![CDATA[
        <h1 id="d3js-chapter-12-geomapping">d3js: chapter 12. geomapping</h1>
<blockquote>
<p>이 글은 <a href="http://infovis.kr">http://infovis.kr</a> 스터디 하면서 작성했고 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ISBN=896626106X">d3.js</a> 12장의 내용이다.</p>
</blockquote>
<h2 id="geojson">GeoJSON</h2>
<pre><code class="lang-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="nt">&quot;features&quot;</span><span class="p">:[{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">주</span> <span class="err">단위</span> <span class="err">데이터</span> <span class="err">타입</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Alabama&quot;</span><span class="p">},</span>
        <span class="nt">&quot;geometry&quot;</span><span class="p">:{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
            <span class="nt">&quot;coordinates&quot;</span><span class="p">:[[[</span><span class="mf">-87.359296</span><span class="p">,</span><span class="mf">35.00118</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-85.606675</span><span class="p">,</span><span class="mf">34.984749</span><span class="p">],</span> <span class="p">[</span><span class="mf">-85.431413</span><span class="p">,</span><span class="mf">34.124869</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-85.184951</span><span class="p">,</span><span class="mf">32.859696</span><span class="p">],</span> <span class="p">[</span><span class="mf">-85.069935</span><span class="p">,</span><span class="mf">32.580372</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-84.960397</span><span class="p">,</span><span class="mf">32.421541</span><span class="p">],</span> <span class="p">[</span><span class="mf">-85.004212</span><span class="p">,</span><span class="mf">32.322956</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-84.889196</span><span class="p">,</span><span class="mf">32.262709</span><span class="p">],</span> <span class="p">[</span><span class="mf">-85.058981</span><span class="p">,</span><span class="mf">32.13674</span><span class="p">],</span>
                <span class="err">...</span>
            <span class="p">]]</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;02&quot;</span><span class="p">,</span>
        <span class="nt">&quot;properties&quot;</span><span class="p">:{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Alaska&quot;</span><span class="p">},</span>
        <span class="nt">&quot;geometry&quot;</span><span class="p">:{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;MultiPolygon&quot;</span><span class="p">,</span>
            <span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span>
                <span class="p">[[[</span><span class="mf">-131.602021</span><span class="p">,</span><span class="mf">55.117982</span><span class="p">],</span> <span class="p">[</span><span class="mf">-131.569159</span><span class="p">,</span><span class="mf">55.28229</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-131.355558</span><span class="p">,</span><span class="mf">55.183705</span><span class="p">],</span> <span class="p">[</span><span class="mf">-131.38842</span><span class="p">,</span><span class="mf">55.01392</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-131.645836</span><span class="p">,</span><span class="mf">55.035827</span><span class="p">],</span> <span class="p">[</span><span class="mf">-131.602021</span><span class="p">,</span><span class="mf">55.117982</span><span class="p">]]],</span>
                <span class="p">[[[</span><span class="mf">-131.832052</span><span class="p">,</span><span class="mf">55.42469</span><span class="p">],[</span><span class="mf">-131.645836</span><span class="p">,</span><span class="mf">55.304197</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-131.749898</span><span class="p">,</span><span class="mf">55.128935</span><span class="p">],[</span><span class="mf">-131.832052</span><span class="p">,</span><span class="mf">55.189182</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-131.832052</span><span class="p">,</span><span class="mf">55.42469</span><span class="p">]]]</span>
                <span class="err">...</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="err">...</span>
<span class="err">}</span>
</pre></div>

</code></pre>
<ul>
<li>Feature가 주 단위 데이터.</li>
<li>좌표는 <del>위도, 경도가 익숙하지만</del> “[경도(latitude), 위도(longitude)]”로 표현: <code>[-131.832052,55.189182]</code><ul>
<li>경도: 세로, 131.832052</li>
<li>위도: 가로, 55.189182</li>
</ul>
</li>
<li>좌표 찾기 from Michal Migurski: <a href="http://teczno.com/squares">http://teczno.com/squares</a></li>
</ul>
<p>이 데이터를 d3로 그려보자:</p>
<p id="phr-path"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Width and height</span>
<span class="kr">const</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

<span class="c1">//Define default path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">();</span>

<span class="c1">//Create SVG element</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-path&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="c1">//Load in GeoJSON data</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">&#39;us-states.json&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">json</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>

    <span class="c1">//Bind data and create one path per GeoJSON feature</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
       <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="nx">path</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

</code></pre>
<h3 id="path">Path</h3>
<p>잠깐 svg path와 d3에서 path 사용하는 방법을 익혀보자. 이 내용은 11장의 pie layout을 설명하는 내용이다.</p>
<p>path는 아래처럼 생김:</p>
<pre><code class="lang-html"><div class="highlight"><pre><span class="nt">&lt;path</span> <span class="na">fill=</span><span class="s">&quot;#d62728&quot;</span> <span class="na">d=</span><span class="s">&quot;M9,184850993605149e-15,-150A150,150 0 0,</span>
<span class="s">    18399621792063931,124.27644738657631L0,0Z&quot;</span><span class="nt">&gt;&lt;/path&gt;</span>
</pre></div>

</code></pre>
<p>pie layout:</p>
<pre><code><div class="highlight"><pre><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">];</span>

<span class="c1">// pie layout</span>
<span class="kd">var</span> <span class="nx">pie</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">layout</span><span class="p">.</span><span class="nx">pie</span><span class="p">();</span>
</pre></div>

</code></pre><p><img src="d3js-layout-pie.png" alt=""></p>
<p>pie chart 그리기:</p>
<div id="phr-pie-chart"></div>

<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Width and height</span>
<span class="kr">const</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">25</span> <span class="p">];</span>

<span class="kd">var</span> <span class="nx">outerRadius</span> <span class="o">=</span> <span class="nx">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">innerRadius</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">arc</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">arc</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">innerRadius</span><span class="p">(</span><span class="nx">innerRadius</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">outerRadius</span><span class="p">(</span><span class="nx">outerRadius</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">pie</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">layout</span><span class="p">.</span><span class="nx">pie</span><span class="p">();</span>

<span class="c1">//Easy colors accessible via a 10-step ordinal scale</span>
<span class="c1">//Synthia Brewer</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">category10</span><span class="p">();</span>

<span class="c1">//Create SVG element</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#phr-pie-chart&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="c1">//Set up groups</span>
<span class="kd">var</span> <span class="nx">arcs</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;g.arc&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">pie</span><span class="p">(</span><span class="nx">dataset</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;arc&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="nx">$</span><span class="p">{</span><span class="nx">outerRadius</span><span class="p">},</span><span class="nx">$</span><span class="p">{</span><span class="nx">outerRadius</span><span class="p">})</span><span class="err">`</span><span class="p">);</span>

<span class="c1">//Draw arc paths</span>
<span class="nx">arcs</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">color</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">arc</span><span class="p">);</span>

<span class="c1">//Labels</span>
<span class="nx">arcs</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="nx">$</span><span class="p">{</span><span class="nx">arc</span><span class="p">.</span><span class="nx">centroid</span><span class="p">(</span><span class="nx">d</span><span class="p">)})</span><span class="err">`</span><span class="p">)</span> <span class="c1">//도형의 중심점에 위치시킨다</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;text-anchor&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</pre></div>

</code></pre>
<ul>
<li>“Synthia Brewer”: 어떤 색 패턴이 사람에게 잘 인식되는지 실험을 통해 찾은 패턴</li>
</ul>
<h2 id="12-3-">12.3 투영법</h2>
<blockquote>
<p>3차원 데이터를 2차원에 투영하는 방법 - p268</p>
</blockquote>
<ul>
<li>Jason Davies: <a href="http://www.jasondavies.com/">http://www.jasondavies.com/</a></li>
<li>D3가 제공하는 Projections: <a href="https://github.com/mbostock/d3/wiki/Geo-Projections">https://github.com/mbostock/d3/wiki/Geo-Projections</a></li>
<li>D3 Projection 비교 해보기: <a href="http://bl.ocks.org/mbostock/3711652">http://bl.ocks.org/mbostock/3711652</a></li>
<li>D3로 그린 한국 지도: <a href="http://codefactory.kr/2013/05/17/korea-map/">http://codefactory.kr/2013/05/17/korea-map/</a></li>
</ul>
<p id="phr-projection"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Width and height</span>
<span class="kr">const</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

<span class="c1">//Define map projection</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">()</span>
    <span class="c1">//.translate([w/3, h/2]); // 위치</span>
    <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">]);</span> <span class="c1">//default 1000</span>

<span class="c1">//Define path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
                 <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>

<span class="c1">//Create SVG element</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#phr-projection&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="c1">//Load in GeoJSON data</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s2">&quot;us-states.json&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">json</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>

    <span class="c1">//Bind data and create one path per GeoJSON feature</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
        <span class="c1">//.attr(&quot;d&quot;, path);</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;steelblue&quot;</span><span class="p">);</span>

<span class="p">});</span>
</pre></div>

</code></pre>
<h2 id="12-4-choropleth-">12.4 단계 구분도(Choropleth)</h2>
<ul>
<li>적색주와 청색주: <a href="http://ko.wikipedia.org/wiki/%EC%A0%81%EC%83%89%EC%A3%BC%EC%99%80_%EC%B2%AD%EC%83%89%EC%A3%BC">http://ko.wikipedia.org/wiki/%EC%A0%81%EC%83%89%EC%A3%BC%EC%99%80_%EC%B2%AD%EC%83%89%EC%A3%BC</a><ul>
<li>영어: <a href="http://en.wikipedia.org/wiki/Red_states_and_blue_states">http://en.wikipedia.org/wiki/Red_states_and_blue_states</a></li>
<li>단점: 인구 밀도는 낮고 큰 지역 처럼 여러 정보는 표현하기 어렵다.</li>
</ul>
</li>
</ul>
<p id="phr-choropleth"></p>

<p>데이터 <code>us-ag-productivity-2004.cvs</code>:</p>
<pre><code><div class="highlight"><pre><span class="nx">state</span><span class="p">,</span><span class="nx">value</span>
<span class="nx">Alabama</span><span class="p">,</span><span class="mf">1.1791</span>
<span class="nx">Arkansas</span><span class="p">,</span><span class="mf">1.3705</span>
<span class="nx">Arizona</span><span class="p">,</span><span class="mf">1.3847</span>
<span class="nx">California</span><span class="p">,</span><span class="mf">1.7979</span>
<span class="nx">Colorado</span><span class="p">,</span><span class="mf">1.0325</span>
</pre></div>

</code></pre><p><code>state,value</code>는 프로퍼티 이름이 된다:</p>
<blockquote>
<p>이 데이터는 미국 농무부(USDA)가 제고앟는 데이터로, 2004년 한 해 동안 믹국 각 주별 농작물 생산 능력을 1996년 앨라바바(Alabama) 주 생산량을 1.0으로 삼아 서 표현한 데이터다. 그러므로 클수록 생산성이 좋은 주가 된다.(미 정부 공개 데이터는 <a href="http://data.gov를">http://data.gov를</a> 통해 제공된다. - p271</p>
</blockquote>
<pre><code><div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="nx">state</span><span class="o">:</span> <span class="s2">&quot;Alabama&quot;</span><span class="p">,</span>
        <span class="nx">value</span><span class="o">:</span> <span class="s2">&quot;1.1791&quot;</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">]</span>
</pre></div>

</code></pre><p>Choropleth 그리기:</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Width and height</span>
<span class="kr">const</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

<span class="c1">//Define map projection</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">()</span>
                       <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
                       <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">]);</span>

<span class="c1">//Define path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
                 <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>

<span class="c1">//Define quantize scale to sort data values into buckets of color</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="s2">&quot;rgb(237,248,233)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(186,228,179)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(116,196,118)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(49,163,84)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(0,109,44)&quot;</span><span class="p">]);</span>
        <span class="c1">//Colors taken from colorbrewer.js, included in the D3 download</span>
        <span class="c1">//domain은 선형이지만 치역이 5개로 매핑됨.</span>
        <span class="c1">//domain은 데이터에서 min, max로 추출한다.</span>

<span class="c1">//Create SVG element</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#phr-choropleth&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="c1">//Load in agriculture data</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s2">&quot;us-ag-productivity-2004.csv&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>

    <span class="c1">//Set input domain for color scale</span>
    <span class="nx">color</span><span class="p">.</span><span class="nx">domain</span><span class="p">([</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">),</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="p">]);</span>

    <span class="c1">//Load in GeoJSON data</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s2">&quot;us-states.json&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">json</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>

        <span class="c1">//Merge the ag. data and GeoJSON</span>
        <span class="c1">//Loop through once for each ag. data value</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="nx">of</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//Find the corresponding state inside the GeoJSON</span>
            <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">f</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">x</span><span class="p">.</span><span class="nx">state</span> <span class="o">==</span> <span class="nx">f</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>

            <span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span>
                <span class="nx">f</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//Bind data and create one path per GeoJSON feature</span>
        <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>
                 <span class="c1">//Get data value</span>
                 <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

                 <span class="k">return</span> <span class="nx">value</span><span class="o">?</span> <span class="nx">color</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="o">:</span> <span class="s2">&quot;#ccc&quot;</span><span class="p">;</span>
            <span class="p">});</span>
    <span class="p">});</span>

<span class="p">});</span>
</pre></div>

</code></pre>
<h2 id="12-5-">12.5 포인트 지점 추가하기.</h2>
<p id="phr-point"></p>

<p><code>us-cities.csv</code>:</p>
<pre><code><div class="highlight"><pre><span class="nx">rank</span><span class="p">,</span><span class="nx">place</span><span class="p">,</span><span class="nx">population</span><span class="p">,</span><span class="nx">lat</span><span class="p">,</span><span class="nx">lon</span>
<span class="mi">1</span><span class="p">,</span><span class="nx">New</span> <span class="nx">York</span> <span class="nx">city</span><span class="p">,</span><span class="mi">8175133</span><span class="p">,</span><span class="mf">40.71455</span><span class="p">,</span><span class="o">-</span><span class="mf">74.007124</span>
<span class="mi">2</span><span class="p">,</span><span class="nx">Los</span> <span class="nx">Angeles</span> <span class="nx">city</span><span class="p">,</span><span class="mi">3792621</span><span class="p">,</span><span class="mf">34.05349</span><span class="p">,</span><span class="o">-</span><span class="mf">118.245323</span>
<span class="mi">3</span><span class="p">,</span><span class="nx">Chicago</span> <span class="nx">city</span><span class="p">,</span><span class="mi">2695598</span><span class="p">,</span><span class="mf">45.37399</span><span class="p">,</span><span class="o">-</span><span class="mf">92.888759</span>
<span class="mi">4</span><span class="p">,</span><span class="nx">Houston</span> <span class="nx">city</span><span class="p">,</span><span class="mi">2099451</span><span class="p">,</span><span class="mf">41.337462</span><span class="p">,</span><span class="o">-</span><span class="mf">75.733627</span>
</pre></div>

</code></pre><ul>
<li>데이터 만들기(저자의 Favorite): <a href="http://www.gpsvisualizer.com/geocoder/">http://www.gpsvisualizer.com/geocoder/</a></li>
<li>데이터 수동 확인: <a href="http://teczno.com/squares">http://teczno.com/squares</a></li>
</ul>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Width and height</span>
<span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

<span class="c1">//Define map projection</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">albersUsa</span><span class="p">()</span>
                   <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
                   <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">500</span><span class="p">]);</span>

<span class="c1">//Define path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
             <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>

<span class="c1">//Define quantize scale to sort data values into buckets of color</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="s2">&quot;rgb(237,248,233)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(186,228,179)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(116,196,118)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(49,163,84)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgb(0,109,44)&quot;</span><span class="p">]);</span>
    <span class="c1">//Colors taken from colorbrewer.js, included in the D3 download</span>

<span class="c1">//Create SVG element</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#phr-point&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="c1">//Load in agriculture data</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s2">&quot;us-ag-productivity-2004.csv&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">//Set input domain for color scale</span>
    <span class="nx">color</span><span class="p">.</span><span class="nx">domain</span><span class="p">([</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">),</span>
        <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="p">]);</span>

    <span class="c1">//Load in GeoJSON data</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s2">&quot;us-states.json&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">json</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>

        <span class="c1">//Merge the ag. data and GeoJSON</span>
        <span class="c1">//Loop through once for each ag. data value</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="nx">of</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//Find the corresponding state inside the GeoJSON</span>
            <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">f</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">x</span><span class="p">.</span><span class="nx">state</span> <span class="o">==</span> <span class="nx">f</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>

            <span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span>
                <span class="nx">f</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//Bind data and create one path per GeoJSON feature</span>
        <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>
                 <span class="c1">//Get data value</span>
                 <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

                 <span class="k">return</span> <span class="nx">value</span><span class="o">?</span> <span class="nx">color</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="o">:</span> <span class="s2">&quot;#ccc&quot;</span><span class="p">;</span>
            <span class="p">});</span>
    <span class="p">});</span>

    <span class="c1">//Load in cities data</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">csv</span><span class="p">(</span><span class="s2">&quot;us-cities.csv&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
            <span class="c1">// scale은 파라미터가 하나고 리턴값이 하나인 함수지만</span>
            <span class="c1">// projection은 파라미터가 두 개고 리턴값이 두 개인 함수.</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;cx&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">projection</span><span class="p">([</span><span class="nx">d</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">lat</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">projection</span><span class="p">([</span><span class="nx">d</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">lat</span><span class="p">])[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1">// Scale을 적용해봄직하다.</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">population</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.00004</span><span class="p">))</span>
            <span class="c1">//.attr(&quot;r&quot;, 5)</span>
            <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

</code></pre>
<h2 id="12-6-">12.6 지오데이터 취득과 분석.</h2>
<h3 id="1-shape-">1. shape 파일 찾기</h3>
<ul>
<li>포멧은 지리 정보 시스템(GIS) 소프트웨어를 사용되는 포멧 - p279</li>
<li>적당한 GeoJSON 데이터를 찾을 수 없으면 Shape 파일 찾자.<ul>
<li>Natural Earth(<a href="http://www.naturalearthdata.com">http://www.naturalearthdata.com</a>): 방대한 지리정보의 보고, 오픈</li>
<li>The United States Census: <a href="http://www.census.gov/geo/www/cob/cbf_state.html">http://www.census.gov/geo/www/cob/cbf_state.html</a></li>
</ul>
</li>
</ul>
<h3 id="2-">2. 축척을 선택</h3>
<p>자료마다 축척이 다를 수도 있지만, 미국 인구조사 세이프 파은 대부분 다음 세가지 중 하나:</p>
<ul>
<li>1:500,000(1:500k)</li>
<li>1:5,000,000(1:5m)</li>
<li>1:20,000,000(1:20m)</li>
</ul>
<p>소축척, 대축척, 고추척:</p>
<ul>
<li>소축척: 1:500k -&gt; 1: 5m -&gt; 1: 20m</li>
<li>대축척, 고추척: 1:500k &lt;- 1: 5m &lt;- 1:20m</li>
</ul>
<p>Natural Earth에서 가장 축척이 작은 오대양 지도(1:110m):</p>
<p><a href="http://www.naturalearthdata.com/downloads/110m-physical-vectors/110m-ocean/">http://www.naturalearthdata.com/downloads/110m-physical-vectors/110m-ocean/</a></p>
<h3 id="3-">3. 세이프를 단순화</h3>
<ul>
<li>마이크 보스탁의 라인을 단순화하는 데모: <a href="http://bost.ocks.org/mike/simplify/">http://bost.ocks.org/mike/simplify/</a><ul>
<li>D3.simplify 플러그인 사용</li>
</ul>
</li>
<li>Matt Bloch의 MapShaper: <a href="http://mapshaper.org">http://mapshaper.org</a><ul>
<li>지도를 단순화 해서 Shapefile, GeoJSON, TopoJSON로 변환할 수 있다.</li>
<li>사용번 p282에 설명함</li>
</ul>
</li>
<li>JavaScript 라이브러리<ul>
<li>Mike Migurski의 Bloch: <a href="https://github.com/migurski/Bloch">https://github.com/migurski/Bloch</a></li>
<li>D3.simplify 플러그인: TopoJSON으로 대체됨.</li>
</ul>
</li>
<li>기하학적 단순화 프로젝트 TopoJSON(<a href="https://github.com/mbostock/topojson">https://github.com/mbostock/topojson</a>)<ul>
<li>GeoJSON 보다 신상이며 효율적</li>
<li><a href="http://bl.ocks.org/4090870">http://bl.ocks.org/4090870</a></li>
</ul>
</li>
</ul>
<h3 id="4-geojson-">4. GeoJSON으로 변환</h3>
<p>Shapefile을 GeoJSON으로 변환하는 <strong>ogr2ogr</strong> 명령어 사용법이 책에 잘 설명돼 있음.</p>
<p>마지막으로 투영법(Projection)을 변경해보는 예제:</p>
<p id="phr-mercator"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Width and height</span>
<span class="kr">const</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">700</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>

<span class="c1">//Define map projection</span>
<span class="c1">//var projection = d3.geo.albersUsa()</span>
<span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">mercator</span><span class="p">()</span>
                       <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
                       <span class="p">.</span><span class="nx">scale</span><span class="p">([</span><span class="mi">100</span><span class="p">]);</span>

<span class="c1">//Define path generator</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
                 <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>

<span class="c1">//Create SVG element</span>
<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#phr-mercator&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="c1">//Load in GeoJSON data</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s2">&quot;oceans.json&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">//Bind data and create one path per GeoJSON feature</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">features</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
       <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>
       <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;steelblue&quot;</span><span class="p">);</span>

<span class="p">});</span>
</pre></div>

</code></pre>
<script>
    runLangJs();
</script>

    ]]></content>
    </entry>
    <entry>
    <title><![CDATA[ d3js: chapter 7. scale ]]></title>
    <link herf="http://pismute.github.io/d3js/07-scale.html" />
    <updated>2015-04-08T07:56:49.943Z</updated>
    <id>http://pismute.github.io/d3js/07-scale.html</id>
    <content type="html"><![CDATA[
        <h1 id="d3js-chapter-7-scale">d3js: chapter 7. scale</h1>
<blockquote>
<p>이 글은 <a href="http://infovis.kr">http://infovis.kr</a> 스터디 하면서 작성했고 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ISBN=896626106X">d3.js</a> 7장의 내용이다.</p>
<p>척도(scale)는 입력되는 정의역(domain)과 출력되는 치역(range)을 매핑한 함수를 말한다.- Mike Bostock</p>
</blockquote>
<ul>
<li>척도는 함수다.</li>
<li>이 장에서는 <a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#linear">Linear Scale</a>만 다룬다.</li>
</ul>
<h2 id="7-5-">7.5 산포도에 척도</h2>
<p id="phr-scatterplot-01"></p>


<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="p">];</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-01&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="7-5-2-">7.5.2 동적인 척도 만들기.</h3>
<p id="phr-scatterplot-02"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="p">];</span>

<span class="c1">//정적 스케일</span>
<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="p">]);</span>

<span class="c1">//동적 스케일</span>
<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span> <span class="c1">// d = [5, 20], ...</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span> <span class="c1">// d = [5, 20], ...</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-02&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="7-5-4-">7.5.4 가공하기</h3>
<h4 id="y-">y축 바꾸기:</h4>
<p id="phr-scatterplot-03"></p>

<pre><code><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="p">];</span>

<span class="c1">//동적 스케일</span>
<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1">// d = [5, 20], ...</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nx">w</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span> <span class="c1">// d = [5, 20], ...</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">//요걸 바꿔 본 것임</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-03&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre><h4 id="padding-">padding 넣기:</h4>
<p id="phr-scatterplot-04"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="p">];</span>

<span class="c1">//////요기</span>
<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span> <span class="c1">//////요기</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">padding</span><span class="p">]);</span> <span class="c1">//////요기</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-04&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<p><a href="http://bl.ocks.org/mbostock/3019563">Mike Bostock’s Margin Convention</a>을 보면 margin 코딩 패턴을 소개하고 있다.</p>
<h4 id="-">반지름도 스케일 적용:</h4>
<p id="phr-scatterplot-05"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="p">];</span>

<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">padding</span><span class="p">]);</span>

<span class="c1">//////반지름용 scale</span>
<span class="kd">var</span> <span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-05&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">rScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span> <span class="c1">//요기</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="-">큰 데이터 추가:</h4>
<p id="phr-scatterplot-06"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span> <span class="c1">//요거 추가.</span>
<span class="p">];</span>

<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">padding</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-06&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">rScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="h-100-300-">h를 100에서 300으로:</h4>
<p id="phr-scatterplot-07"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span> <span class="c1">//요거 추가.</span>
<span class="p">];</span>

<span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">padding</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-07&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">rScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="-">기타 척도 메소드</h3>
<h4 id="linear">Linear</h4>
<h5 id="-nice-https-github-com-mbostock-d3-wiki-quantitative-scales-linear_nice-"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#linear_nice">nice()</a></h5>
<p>정의역 반올림.</p>
<p><strong>scale(0)</strong>:<p id="nice-01"></p>
<strong>scale(0.123)</strong>:<p id="nice-02"></p>
<strong>scale(4.567)</strong>:<p id="nice-03"></p></p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">scale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mf">0.123</span><span class="p">,</span> <span class="mf">4.567</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">nice</span><span class="p">();</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#nice-01&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#nice-02&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mf">0.123</span><span class="p">));</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#nice-03&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mf">4.567</span><span class="p">));</span>
</pre></div>

</code></pre>
<h5 id="-rangeround-http-bit-ly-z2zlke-"><a href="http://bit.ly/Z2ZLke">rangeRound()</a></h5>
<blockquote>
<p>안티에일리어싱(antialiasing)으로 발생할 수 있는 뿌연 경계선이 없는, 정확한 픽셀 값을 갖는 도형을 그릴 때 유용하다. - p151</p>
</blockquote>
<p>치역 반올림.</p>
<p><strong>scale(0)</strong>:<p id="range-round-01"></p>
<strong>scale(0.123)</strong>:<p id="range-round-02"></p>
<strong>scale(4.567)</strong>:<p id="range-round-03"></p></p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">scale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mf">0.123</span><span class="p">,</span> <span class="mf">4.567</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">rangeRound</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">nice</span><span class="p">();</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#range-round-01&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#range-round-02&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mf">0.123</span><span class="p">));</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#range-round-03&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mf">4.567</span><span class="p">));</span>
</pre></div>

</code></pre>
<h5 id="-clamp-http-bit-ly-12h7utf-"><a href="http://bit.ly/12h7uTf">clamp()</a></h5>
<p>기본적으로 d3는 치역 밖에 값도 반환해주지만, 정의한 치역 범위를 벗어나는 경우 치역의 최소값과 최대값 중 하나를 반환한다.</p>
<p><strong>scale(10)</strong>:<p id="clamp-01"></p></p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">scale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mf">0.123</span><span class="p">,</span> <span class="mf">4.567</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">]);</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#clamp-01&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
</pre></div>

</code></pre>
<p><strong>scale(10)</strong>:<p id="clamp-02"></p></p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">scale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mf">0.123</span><span class="p">,</span> <span class="mf">4.567</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">clamp</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#clamp-02&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">scale</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
</pre></div>

</code></pre>
<h2 id="7-8-">7.8 다른 종류의 척도</h2>
<p>다른 척도로 이런게 있는데, 언젠가 업데이트를….</p>
<h4 id="-sqrt-https-github-com-mbostock-d3-wiki-quantitative-scales-sqrt-"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#sqrt">sqrt</a></h4>
<h4 id="-pow-https-github-com-mbostock-d3-wiki-quantitative-scales-pow-"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#pow">pow</a></h4>
<h4 id="-log-https-github-com-mbostock-d3-wiki-quantitative-scales-log-scales-"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#log-scales">log</a></h4>
<h4 id="-quantize-https-github-com-mbostock-d3-wiki-quantitative-scales-quantize-scales-"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#quantize-scales">quantize</a></h4>
<h4 id="-quantile-https-github-com-mbostock-d3-wiki-quantitative-scales-quantile-scales-"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#quantile-scales">quantile</a></h4>
<h4 id="-ordinal-https-github-com-mbostock-d3-wiki-ordinal-scales-"><a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales">ordinal</a></h4>
<h5 id="-d4-scale-category10-https-github-com-mbostock-d3-wiki-ordinal-scales-category10-"><a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales#category10">d4.scale.category10</a></h5>
<h5 id="-d4-scale-category20-https-github-com-mbostock-d3-wiki-ordinal-scales-category20-"><a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales#category20">d4.scale.category20</a></h5>
<h5 id="-d4-scale-category20b-https-github-com-mbostock-d3-wiki-ordinal-scales-category20b-"><a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales#category20b">d4.scale.category20b</a></h5>
<h5 id="-d4-scale-category20c-https-github-com-mbostock-d3-wiki-ordinal-scales-category20c-"><a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales#category20c">d4.scale.category20c</a></h5>
<h4 id="-d3-time-scale-https-github-com-mbostock-d3-wiki-time-scales-"><a href="https://github.com/mbostock/d3/wiki/Time-Scales">d3.time.scale()</a></h4>
<script>
    runLangJs()
</script>

    ]]></content>
    </entry>
    <entry>
    <title><![CDATA[ d3js: chapter 8. axis ]]></title>
    <link herf="http://pismute.github.io/d3js/08-axis.html" />
    <updated>2015-04-08T07:56:49.943Z</updated>
    <id>http://pismute.github.io/d3js/08-axis.html</id>
    <content type="html"><![CDATA[
        <h1 id="d3js-chapter-8-axis">d3js: chapter 8. axis</h1>
<blockquote>
<p>이 글은 <a href="http://infovis.kr">http://infovis.kr</a> 스터디 하면서 작성했고 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ISBN=896626106X">d3.js</a> 8장의 내용이다.</p>
</blockquote>
<h2 id="-axis-https-github-com-mbostock-d3-wiki-svg-axes-"><a href="https://github.com/mbostock/d3/wiki/SVG-Axes">Axis</a></h2>
<p>이 페이지 내내 사용하는 공통 코드(7장의 내용):</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//global로 선언하는 것은 안좋은 습관이지만,</span>
<span class="c1">//아래 예제에서 계속 사용하기 위해 global로 선언한다.</span>
<span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">h</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">padding</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="p">];</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">padding</span><span class="p">]);</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>

<span class="c1">//global</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">scatterplot</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

    <span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">rScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">});</span>

    <span class="k">return</span> <span class="nx">svg</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

</code></pre>
<p>산포도 그리기:</p>
<p id="phr-scatterplot-01"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//svg.append(&#39;g&#39;)</span>
<span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-01&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">));</span>
</pre></div>

</code></pre>
<p>Axis그릴려면 많은 SVG 엘리먼트가 필요한데 그 엘리먼트를 담는 Container 역활엔 Group을 의미하는 <code>g</code>가 적합하다:</p>
<p><strong>bottom에 그렸는데 위에 나온다.ㅎㅎ</strong></p>
<h3 id="8-3-">8.3 보기 좋게 다듬기.</h3>
<p id="phr-scatterplot-02"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-02&#39;</span><span class="p">)</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;axis&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<pre><code class="lang-css"><div class="highlight"><pre><span class="nc">.axis</span> <span class="nt">path</span><span class="o">,</span>
<span class="nc">.axis</span> <span class="nt">line</span> <span class="p">{</span>
    <span class="n">fill</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
    <span class="n">stroke</span><span class="o">:</span> <span class="nb">black</span><span class="p">;</span>
    <span class="n">shape</span><span class="o">-</span><span class="n">rendering</span><span class="o">:</span> <span class="n">scrispEdges</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.axis</span> <span class="nt">text</span> <span class="p">{</span>
    <span class="k">font-family</span><span class="o">:</span> <span class="k">sans-serif</span><span class="p">;</span>
    <span class="k">font-size</span><span class="o">:</span> <span class="m">11px</span><span class="p">;</span>
    <span class="n">fill</span><span class="o">:</span> <span class="nb">olive</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

</code></pre>
<style>
.axis path,
.axis line {
    fill: none;
    stroke: black;
    shape-rendering: scrispEdges;
}
.axis text {
    font-family: sans-serif;
    font-size: 11px;
    fill: olive;
}
</style>

<h4 id="transform">transform</h4>
<p>위치를 이동시키자:</p>
<p id="phr-scatterplot-03"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-03&#39;</span><span class="p">)</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span> <span class="c1">//translate(0, 280)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="8-4-">8.4 눈금 생성 시 확인 사항</h3>
<p>7개나 5개 d3가 생성해주는 눈금 개 수는 같다. d3는 <code>ticks()</code>로 설정한 눈금 근처로 해서 데이터에 맞는 눈금 개수를 알아서 생성해준다:</p>
<p id="phr-scatterplot-04"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-04&#39;</span><span class="p">)</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<p id="phr-scatterplot-05"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-05&#39;</span><span class="p">)</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="y-">Y축도 만들자</h3>
<p id="phr-scatterplot-06"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">padding</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>

<span class="c1">//아래 예제에서 재정의 하기 귀찮으니 글로벌로 선언한다.</span>
<span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="nb">window</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">yAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">yScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-06&#39;</span><span class="p">);</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="nx">$</span><span class="p">{</span><span class="nx">padding</span><span class="p">},</span> <span class="mi">0</span><span class="p">)</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h2 id="8-6-">8.6 마지막 손질</h2>
<p id="phr-scatterplot-07"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="nb">window</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">dataset</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">numDataPoints</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">xRange</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">yRange</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numDataPoints</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">newNumber1</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">xRange</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">newNumber2</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">xRange</span><span class="p">);</span>
    <span class="nx">dataset</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">newNumber1</span><span class="p">,</span> <span class="nx">newNumber2</span><span class="p">]);</span>
<span class="p">}</span>

<span class="c1">//데이터가 달라졌으니 Scale도 다시(계속 위 예제의 것을 재사용 함) 만들고</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">padding</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">h</span><span class="o">-</span><span class="nx">padding</span><span class="p">,</span> <span class="nx">padding</span><span class="p">]);</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">rScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>

<span class="c1">//Scale이 바뀌었으니 Axis도</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="nx">g</span><span class="p">.</span><span class="nx">yAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">yScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-07&#39;</span><span class="p">);</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="nx">$</span><span class="p">{</span><span class="nx">padding</span><span class="p">},</span> <span class="mi">0</span><span class="p">)</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">yScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="text-">text 제거</h4>
<p id="phr-scatterplot-08"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-08&#39;</span><span class="p">);</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="nx">$</span><span class="p">{</span><span class="nx">padding</span><span class="p">},</span> <span class="mi">0</span><span class="p">)</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>
</pre></div>

</code></pre>
<h2 id="8-7-">8.7 눈금의 라벨 포매팅</h2>
<p><a href="https://github.cm/mbostock/d3/wiki/Formatting#d3_format">d3.format</a></p>
<p id="phr-scatterplot-09"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">xScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">tickFormat</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;.1%&#39;</span><span class="p">));</span>

<span class="kd">var</span> <span class="nx">yAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">axis</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">yScale</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">orient</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">ticks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">tickFormat</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;03d&#39;</span><span class="p">));</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">scatterplot</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot-09&#39;</span><span class="p">);</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">h</span> <span class="o">-</span> <span class="nx">padding</span><span class="p">})</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="err">`</span><span class="nx">translate</span><span class="p">(</span><span class="nx">$</span><span class="p">{</span><span class="nx">padding</span><span class="p">},</span> <span class="mi">0</span><span class="p">)</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">yAxis</span><span class="p">);</span>
</pre></div>

</code></pre>
<script>
    runLangJs()
</script>

    ]]></content>
    </entry>
    <entry>
    <title><![CDATA[ d3js: chapter 5. data ]]></title>
    <link herf="http://pismute.github.io/d3js/05-data.html" />
    <updated>2015-04-08T07:56:49.943Z</updated>
    <id>http://pismute.github.io/d3js/05-data.html</id>
    <content type="html"><![CDATA[
        <h1 id="d3js-chapter-5-data">d3js: chapter 5. data</h1>
<blockquote>
<p>이 글은 <a href="http://infovis.kr">http://infovis.kr</a> 스터디 하면서 작성했고 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ISBN=896626106X">d3.js</a> 5장의 내용이다.</p>
</blockquote>
<style>
circle {
    fill: none;
    fill-opacity: .2;
    stroke: black;
    stroke-width: 1.5px;
</style>

<p id="phr-scatch"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">];</span>

<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatch&#39;</span><span class="p">).</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">$d</span><span class="o">:</span> <span class="nx">New</span> <span class="nx">paragraph</span><span class="o">!</span><span class="err">`</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">(</span><span class="nx">d</span><span class="o">&gt;</span><span class="mi">15</span><span class="p">)</span><span class="o">?</span> <span class="s1">&#39;red&#39;</span><span class="o">:</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="data-join-thinking-with-joins-mike-bostocks-http-bost-ocks-org-mike-join-">Data Join - <a href="http://bost.ocks.org/mike/join/">Thinking with Joins - mike bostocks</a></h3>
<p><code>selectAll(&quot;circle&quot;)</code>은 “circle” 엘리먼트랑 data랑 역는 행위:</p>
<p id="phr-join"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#phr-join&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="mi">720</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="mi">240</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="s2">&quot;translate(0,128)&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="s2">&quot;translate(300)&quot;</span><span class="p">);</span>

<span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;#3182bd&quot;</span><span class="p">);</span>

<span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;font-weight&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">);</span>

<span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Enter&quot;</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">360</span><span class="p">).</span>
    <span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Update&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">elements</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="s2">&quot;translate(420)&quot;</span><span class="p">);</span>

<span class="nx">elements</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;#e6550d&quot;</span><span class="p">);</span>

<span class="nx">elements</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Elements&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;font-weight&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">);</span>

<span class="nx">elements</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="mi">110</span><span class="p">);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;dy&quot;</span><span class="p">,</span> <span class="s2">&quot;.35em&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;text-anchor&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">);</span>
</pre></div>

</code></pre>
<ul>
<li>update(inner) selection: Data points joined to <strong>existing elements</strong></li>
<li>enter(left) selection: Leftover <strong>unbound data</strong> produce the enter</li>
<li>exit(right) selection: <strong>any remaining unbound elements</strong></li>
</ul>
<p>update/enter/exit selection을 어떤식으로 코딩해야 할지는 <a href="http://bl.ocks.org/mbostock/3808218">General Update Pattern, I</a>를 보는게 좋다.</p>
<h4 id="update-exit-selection-">Update/Exit Selection:</h4>
<div id="phr-join-update">
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
</div>

<pre><code class="lang-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;phr-join-update&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;div&gt;&lt;/div&gt;</span> //no selection
    <span class="nt">&lt;div&gt;&lt;/div&gt;</span> //no selection
<span class="nt">&lt;/div&gt;</span>
</pre></div>

</code></pre>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>

<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-join-update&#39;</span><span class="p">).</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span> <span class="c1">//return update selection</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">$d</span><span class="o">:</span> <span class="nx">update</span> <span class="nx">selection</span><span class="err">`</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;exit selection&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="enter-selection-">Enter Selection:</h4>
<div id="phr-join-enter">
    <p></p>
    <p></p>
    <p></p>
</div>

<pre><code class="lang-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;phr-join-enter&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

</code></pre>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">];</span>

<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-join-enter&#39;</span><span class="p">).</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">)</span> <span class="c1">//return update selection</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">$d</span><span class="o">:</span> <span class="nx">update</span> <span class="nx">selection</span><span class="err">`</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>    <span class="c1">//return enter selection</span>
        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">$d</span><span class="o">:</span> <span class="nx">enter</span> <span class="nx">selection</span><span class="err">`</span> <span class="p">)</span>
        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="transition">Transition</h4>
<p>d3js 책 9장에서 배운다:</p>
<script>
    runLangJs()
</script>

    ]]></content>
    </entry>
    <entry>
    <title><![CDATA[ d3js: chapter 6. drawing with data ]]></title>
    <link herf="http://pismute.github.io/d3js/06-drawing-with-data.html" />
    <updated>2015-04-08T07:56:49.944Z</updated>
    <id>http://pismute.github.io/d3js/06-drawing-with-data.html</id>
    <content type="html"><![CDATA[
        <h1 id="d3js-chapter-6-drawing-with-data">d3js: chapter 6. drawing with data</h1>
<blockquote>
<p>이 글은 <a href="http://infovis.kr">http://infovis.kr</a> 스터디 하면서 작성했고 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ISBN=896626106X">d3.js</a> 6장의 내용이다.</p>
</blockquote>
<h2 id="6-3-1-svg-">6.3.1 SVG를 만들어 보자</h2>
<p id="phr-svg-sample"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">];</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-svg-sample&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">(</span><span class="nx">i</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</pre></div>

</code></pre>
<h2 id="6-4-">6.4 막대 차트 만들기.</h2>
<p id="phr-bar-chart"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">barPadding</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-bar-chart&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">rect</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">i</span> <span class="o">*</span> <span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">h</span> <span class="o">-</span> <span class="nx">d</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="o">/</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">barPadding</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">$d</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="err">`</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">i</span> <span class="o">*</span> <span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">w</span><span class="o">/</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">barPadding</span><span class="p">)</span> <span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">h</span> <span class="o">-</span> <span class="p">(</span><span class="nx">d</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">14</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;text-anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;middle&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h2 id="6-5-scatterplot-">6.5 산포도(scatterplot) 만들기</h2>
<p id="phr-scatterplot"></p>

<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">500</span>
<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">100</span>
<span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">330</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">410</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">475</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
<span class="p">];</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#phr-scatterplot&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">circle</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>

<span class="nx">text</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]},</span> <span class="nx">$</span><span class="p">{</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span><span class="err">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;font-size&#39;</span><span class="p">,</span> <span class="s1">&#39;11px&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<script>
    runLangJs();
</script>

    ]]></content>
    </entry>
</feed>

        </div>
        <footer class="footer">
            <p>Copyright &copy; 2015+ Changwoo Park</p>
            <p><small>Powered by <a href="https://github.com/pismute/gulp-makdoc">makdoc</a>, <a href="http://fezvrasta.github.io/bootstrap-material-design/">bootstrap-material-design</a></small></p>
        </footer>
    </div>

    <script
        src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <script
        src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>
    <script
        src="/scripts/script.js"></script>

    <script
        src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.2.2/js/ripples.min.js"></script>
    <script
        src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/0.2.2/js/material.min.js"></script>
    <script>
        $(function(){
            $.material.init();
        });
    </script>

    <script>

    </script>
</body>
</html>
